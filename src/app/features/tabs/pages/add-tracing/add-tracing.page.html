<ion-header [translucent]="true">
  <ion-toolbar class="toolbar">
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/tracing"></ion-back-button>
    </ion-buttons>
    <ion-title>Registro de seguimiento</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <section class="ion-margin">
    <form [formGroup]="detailForm">
      <ion-grid>
        <ion-row>
          <ion-col>
            <ion-input label="Región" label-placement="floating" fill="outline" type="text" class="ion-margin-bottom" formControlName="region"></ion-input>
            <ion-select label="Zona" label-placement="floating" fill="outline" class="ion-margin-bottom" formControlName="zone">
              <ion-select-option value="apple">Apple</ion-select-option>
              <ion-select-option value="banana">Banana</ion-select-option>
              <ion-select-option value="orange">Orange</ion-select-option>
            </ion-select>
            <ion-input label="Sede" label-placement="floating" fill="outline" type="text" class="ion-margin-bottom" formControlName="headquarter"></ion-input>
            <ion-select label="Actividad" label-placement="floating" fill="outline" class="ion-margin-bottom" formControlName="activity">

            </ion-select>

          </ion-col>
          <ion-col>
            <ion-input label="Departamento" label-placement="floating" fill="outline" type="text" class="ion-margin-bottom" formControlName="department"></ion-input>
            <ion-select label="Municipio" label-placement="floating" fill="outline" class="ion-margin-bottom" formControlName="city">

            </ion-select>
            <!-- <ion-input label="Tutor" label-placement="floating" fill="outline" type="text" class="ion-margin-bottom" formControlName="tutor"></ion-input> -->
            <ion-select label="Enfoque" label-placement="floating" fill="outline" class="ion-margin-bottom" formControlName="approach">

            </ion-select>
            <ion-select label="Subactividad" label-placement="floating" fill="outline" class="ion-margin-bottom" formControlName="subactivity">

            </ion-select>
          </ion-col>
        </ion-row>
      </ion-grid>
    </form>
    <div class="subtitle-btn">
      <h4>Evidencia fotográfica</h4>
      <ion-button expand="block" [routerLink]="['/tracing/photo-evidence/add']">Agregar</ion-button>
    </div>
    @if(photoData().length){
      <ion-grid>
        <ion-col>
          <ion-card>
            <table class="act-table">
              <tr>
                <th class="no-expand">Nombre</th>
                <th>Fecha</th>
                <th>Ver detalle</th>
              </tr>
              @for (item of photoData(); track item.id){
                <tr>
                  <td class="no-expand">{{item.name}}</td>
                  <td>{{item.date}}</td>
                  <td>
                    <div class="actions-btns">
                      <ion-button fill="clear" color="primary"  [routerLink]="['/tracing/photo-evidence', item.id]">
                        <ion-icon slot="icon-only" name="eye-outline"></ion-icon>
                      </ion-button>
                      <ion-button fill="clear" color="primary"  [routerLink]="['/tracing/photo-evidence', item.id]">
                        <ion-icon slot="icon-only" name="create-outline"></ion-icon>
                      </ion-button>
                      <ion-button fill="clear" color="primary">
                        <ion-icon slot="icon-only" name="trash-outline"></ion-icon>
                      </ion-button>
                    </div>
                  </td>
                </tr>
              }
            </table>
          </ion-card>
        </ion-col>
      </ion-grid>
    }
    <ion-textarea rows="3" label="Descripción" placeholder="Escribe aquí" label-placement="floating" fill="outline" type="text" class="ion-margin-vertical" [autoGrow]="true" [formControl]="description"></ion-textarea>
    <ion-textarea rows="3" label="Novedades" placeholder="Escribe aquí" label-placement="floating" fill="outline" type="text" class="ion-margin-bottom" [autoGrow]="true" [formControl]="news"></ion-textarea>
    <div class="subtitle-btn">
      <h4>Anexos</h4>
      <ion-button expand="block" [routerLink]="['/tracing/attached/add']">Agregar</ion-button>
    </div>
    <ion-grid>
      <ion-col>
        <ion-card>
          <table>
            <tr>
              <th class="no-expand">Nombre</th>
              <th>Ver detalle</th>
            </tr>
            @for (item of photos; track item.name){
              <tr>
                <td class="no-expand">{{item.name}}</td>
                <td>
                  <ion-button fill="clear" color="primary" [routerLink]="['/tracing', 'attached', item.id]">
                  <!-- <ion-button fill="clear" color="primary" [routerLink]="['/tracing', currentId, 'attached', item.id]"> -->
                    <ion-icon slot="icon-only" name="eye-outline"></ion-icon>
                  </ion-button>
                </td>
              </tr>
            }
          </table>
        </ion-card>
      </ion-col>
    </ion-grid>
  </section>
</ion-content>
